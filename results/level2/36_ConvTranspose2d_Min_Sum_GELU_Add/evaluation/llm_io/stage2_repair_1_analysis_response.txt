```json
{
  "critical_issue": "Python `if` statement on Triton tensor `h_mask[h_idx]` in kernel.",
  "why_it_matters": "Triton kernels cannot use Python control flow on runtime values; must use `tl.where` or masking.",
  "minimal_fix_hint": "Replace `if h_mask[h_idx]:` with masked operations using `tl.where`."
}
```